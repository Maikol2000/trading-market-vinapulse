<!-- okx.component.html -->
<div class="okx-container">
  <h2>OKX API Integration</h2>

  <div class="card">
    <div class="card-header">
      <h3>Market Data</h3>
      <button (click)="getBTCTicker()" [disabled]="isLoading">
        Refresh BTC-USDT Ticker
      </button>
    </div>

    <div class="card-body" *ngIf="marketData.length > 0">
      <div *ngFor="let item of marketData">
        <p><strong>Last Price:</strong> {{ item.last }}</p>
        <p><strong>24h High:</strong> {{ item.high24h }}</p>
        <p><strong>24h Low:</strong> {{ item.low24h }}</p>
        <p><strong>24h Volume:</strong> {{ item.vol24h }}</p>
        <p><strong>24h Change:</strong> {{ item.sodUtc0 }}%</p>
      </div>
    </div>

    <div
      class="card-body"
      *ngIf="marketData.length === 0 && !isLoading && !errorMessage"
    >
      <p>No market data available. Click the button to fetch data.</p>
    </div>
  </div>

  <div class="card mt-4">
    <div class="card-header">
      <h3>Account Information</h3>
      <button (click)="getAccountBalance()" [disabled]="isLoading">
        Get Account Balance
      </button>
    </div>

    <div class="card-body" *ngIf="accountBalance">
      <div *ngFor="let currency of accountBalance[0]?.details">
        <p>
          <strong>{{ currency.ccy }}:</strong> {{ currency.availBal }}
        </p>
      </div>
    </div>

    <div
      class="card-body"
      *ngIf="!accountBalance && !isLoading && !errorMessage"
    >
      <p>
        No account data available. Click the button to fetch your account
        balance.
      </p>
      <p class="note">Note: This requires API key authentication.</p>
    </div>
  </div>

  <div class="card mt-4">
    <div class="card-header">
      <h3>Place Order</h3>
      <button (click)="placeOrder()" [disabled]="isLoading">
        Place Sample BTC Order
      </button>
    </div>

    <div class="card-body">
      <p>
        This will attempt to place a limit order to buy 0.001 BTC at $20,000.
      </p>
      <p class="note">
        Note: This is just an example. The order will likely not be executed.
      </p>
      <p class="note">
        This requires API key authentication with trading permissions.
      </p>
    </div>
  </div>

  <div class="loading-spinner" *ngIf="isLoading">Loading...</div>

  <div class="error-message" *ngIf="errorMessage">
    {{ errorMessage }}
  </div>
</div>
